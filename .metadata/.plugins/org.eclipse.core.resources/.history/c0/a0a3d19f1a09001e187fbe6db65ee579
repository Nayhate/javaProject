package principal.telas;

import java.util.List;

import principal.controladores.CadastroFuncionario;
import principal.controladores.ControleDePedido;
import principal.modelos.Funcionario;
import principal.modelos.Pedido;
import principal.util.Prompt;

public class TelaDeGerenciamentoPedido {
	
	public static void mostrar() {
		
		Prompt.linhaEmBranco();
		Prompt.imprimir("Tela de Gerenciamento de Pedidos");

		Prompt.imprimir("[1] Listar");
		Prompt.imprimir("[2] Cancelar");
		Prompt.imprimir("[3] Voltar");
		
		Integer opcao = Prompt.lerInteiro();

		switch (opcao) {
			case 1: {
				TelaDeGerenciamentoPedido.listar();
				break;
			}
			case 2: {
				TelaDeGerenciamentoPedido.cancelar();
				break;
			}
			case 3: {
				TelaDeGerenciamento.mostrar();
				break;
			}
		}
	}

	public static void listar() {

		Prompt.linhaEmBranco();
		Prompt.imprimir("Lista de Pedidos");
		
		ControleDePedido cadastro = ControleDePedido.getInstance();
		
		List<Pedido> pedidos = cadastro.getPedidos();
		if (pedidos.isEmpty()) {
			Prompt.imprimir("Lista Vazia"); 
		} else {
			for (Pedido pedido : pedidos) {
				Prompt.imprimir(pedido.toString());
			}
		}
		
		Prompt.linhaEmBranco();
		Prompt.pressionarEnter();
		TelaDeGerenciamentoPedido.mostrar();
	}

	private static void cancelar() {

		Prompt.linhaEmBranco();
		Prompt.imprimir(Mensagem.MSG_LISTA_DE_PEDIDOS);
		Prompt.imprimir(Mensagem.MSG_ESCOLHA);
		if (Banco.pedidos.isEmpty()) {
			Prompt.imprimir(Mensagem.MSG_NENHUM_PEDIDO); 
		} else {
			for (Pedido pedido : Banco.pedidos) {
				Prompt.imprimir("[" + pedido.codigo + "] " + pedido.toString());
			}
		}
		Prompt.linhaEmBranco();
		Integer codigo = Prompt.lerInteiro(Mensagem.MSG_INFORME_CODIGO);
		
		if (codigo > 0) {
			Pedido pedidoCancelar = ControleDePedidos.buscar(codigo);
			
			Prompt.linhaEmBranco();
			if (pedidoCancelar != null) {
				pedidoCancelar.status = Status.CANCELADO;
				ControleDePedidos.cancelar(codigo, pedidoCancelar);
				Prompt.imprimir(Mensagem.MSG_PEDIDO_CANCELADO);
			} else {
				Prompt.imprimir(Mensagem.MSG_PEDIDO_NAO_ENCONTRADO);
			}
			Prompt.linhaEmBranco();
			Prompt.pressionarEnter();
		}
		TelaDePedidos.listar();
	}
}
